version: '3.8'

services:
  ssh-server:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: broxeen-ssh-test
    hostname: ssh-test-host
    ports:
      - "2222:22"
    networks:
      - broxeen-test
    environment:
      - TZ=Europe/Warsaw
    volumes:
      - ./test-data:/test-data:ro
    healthcheck:
      test: ["CMD", "nc", "-z", "localhost", "22"]
      interval: 5s
      timeout: 3s
      retries: 3
      start_period: 10s

  # Additional SSH server for multi-host testing
  ssh-server-2:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: broxeen-ssh-test-2
    hostname: ssh-test-host-2
    ports:
      - "2223:22"
    networks:
      - broxeen-test
    environment:
      - TZ=Europe/Warsaw

networks:
  broxeen-test:
    driver: bridge
    ipam:
      config:
        - subnet: 172.28.0.0/16
